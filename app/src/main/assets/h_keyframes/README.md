# 关键H帧

## 何为关键H帧？

就是影片到达「**顶点**」的那一刻。

还在因为不能和影片内「顶点」同步，而不停地记着「顶点」的时刻然后看进度条卡时间同步吗？

现在你可能不需要了。如果你开启了该功能（默认开启），并且在影片内**手动标记**每一个关键H帧，它会在 5-30s
前在屏幕**左上角**倒计时提醒（可调整）。在 0-1s 时，会精确到一位小数，方便你更好的控制时间。

此外，还提供了**共享关键H帧集**。这些关键H帧是内置于软件里的，来源于贡献者在 GitHub
上的补充。目前是随着版本更新（或 CI 实时更新）来更新共享关键H帧集，暂时不考虑服务器在线共享之类的（太危险）。

[共享关键库位置](./)

## 须知

1. 中字候补（生肉，字幕未上传）时**不要**上传，因为出字幕后可能会与未出字幕前**有一定的时间差**，导致时间不准。
2. 每一个关键H帧的`prompt`尽可能短，因为太长会影响观看。
3. 两个关键H帧必须**间隔 5s 及以上**！

## 怎么共享关键H帧？

> 注意：共享关键H帧是无法在程序内部修改的，只可读。

### Fork & Clone

先把我项目 Fork 了，然后从你项目里 Clone 到本地。

fork 仓库步骤：

1. 登录GitHub账号，进入要fork的仓库页面。
2. 点击右上角的“Fork”按钮。
3. 等待一段时间后，就可以在个人的GitHub仓库中看到已经fork过来的仓库。

clone 仓库步骤：

1. 在要clone的仓库页面上找到“clone with HTTPS”或“clone with SSH”按钮，并复制HTTPS或SSH地址。
2. 在本地打开终端（或命令行界面），进入要存放仓库的文件夹。
3. 输入命令 `git clone <复制的仓库地址>`，其中`<复制的仓库地址>`替换为刚才复制的地址。
4. 等待一段时间后，就可以在本地文件夹中看到已经克隆过来的仓库。

以上步骤完成后，就可以在本地使用这个仓库了。

### 创建文件

在该 md 文件所处的文件夹下创建一个 JSON 文件，命名为 `<影片代号>.json`。
该影片代号从哪里来呢？举个例子，你所看的番，网址是`https://hanime1.me/watch?v=37453`
，它的代号就是`v=`后面的`37453`。如果你想共享该影片的关键H帧，你需要创建名为`37453.json`的文件。

### 了解并编写 JSON 结构

以代号为`84711`的影片为例（内容我乱填的），就按这个格式写：

```json
{
  "videoCode": "84711",
  "group": "aaa",
  "title": "abc",
  "episode": 1,
  "author": "yenaly",
  "keyframes": [
    {
      "position": 1000000,
      "prompt": "abc"
    },
    {
      "position": 2000000,
      "prompt": null
    }
  ]
}
```

介绍一下每一个键值是干什么的：

> 注意-1：`author`为`null`时代表个人本地储存的，不为空才代表是共享的。所以不允许 JSON 文件里出现`null`的`author`。
>
> 注意-2：编写前务必查询当前已上传的关键H帧是否存在。假设有一人已上传 AAA 的第一集，group 名为`aaa`，title 为`aaa-01`，你也要按照他的方式进行修改，不要自行更改 group 名为`AAA`。如果你觉得你的命名更准确、更优质，也可以选择将其所有当前系列的group名和title名一起修改。

| 键        | 值类型            | 作用                                                         |
| --------- | ----------------- | ------------------------------------------------------------ |
| videoCode | string (not null) | 影片代号，用于识别影片                                       |
| group     | string (nullable) | 影片系列名称，用于影片分组，为 null 代表无系列               |
| title     | string (not null) | 影片标题，看得清晰些                                         |
| episode   | number            | 影片集数，如果无系列请填 0                                   |
| author    | string (not null) | 关键H帧作者，也就是你，**而不是**影片作者！                  |
| keyframes | array             | 关键H帧列表                                                  |
| position  | number            | 「顶点」位置，怎么获取下面说，两个 position 必须间隔 5s 及以上 |
| prompt    | string (nullable) | 「顶点」提示，最好少于五个字，或 null                        |

#### 怎么获取「顶点」位置？

首先要打开关键H帧功能，然后进入该影片全屏界面，在「顶点」处暂停，长按选单栏的`🥵`按钮，会弹出一个窗口，例如：

> ......
>
> 当前时刻：1830ms

此时，`1830`就是你所需要填写的`position`数值。同时，你也可以在此时保存到你的个人本地关键H帧中。

### Commit & Push

将代码提交到本地仓库和推送到远程仓库的步骤如下：

commit 到本地仓库：

1. 在本地文件夹中找到要修改的代码文件。
2. 对代码进行修改、添加或删除。
3. 使用命令 `git add <文件名>` 将修改后的文件添加到暂存区，也可以使用 `git add .` 将所有修改后的文件添加到暂存区。
4. 使用命令 `git commit -m "<提交信息>"` 提交暂存区的文件到本地仓库，其中 `<提交信息>` 是本次提交的说明。

push 到远程仓库：

1. 使用命令 `git push origin <分支名>` 将当前分支推送到远程仓库，其中 `<分支名>`
   是要推送的分支名称。例如，如果要将当前分支推送到远程主机的 master
   分支，可以输入 `git push origin master`。

以上步骤完成后，就可以将代码从本地仓库推送到远程仓库了。

> 注意，提交信息的格式为：`[HKeyframe] 添加/修改/删除 <影片名称>`
>
> 简繁都行，英文也行。
>
> 例如：`[HKeyframe] 添加 初恋时间系列`

### Pull Request

从我本体的 Pull Request 里提交合并请求，如果没什么大问题就合并了。

以下是Pull Request的步骤：

1. 确认分支：首先，确保你已经在本地仓库中创建了一个新的分支，并且在该分支上进行了修改。
2. 创建远程分支：将本地分支推送到远程仓库中，可以使用 `git push -u origin <分支名>`
   命令，其中 `<分支名>` 是当前分支的名称。
3. 打开 GitHub 页面：在浏览器中打开目标仓库的页面，并切换到要合并的分支。
4. 创建 Pull Request：在页面上找到 “New Pull Request” 按钮，点击后会出现一个新的页面，其中包含了你推送的分支和目标仓库的信息。
5. 填写 Pull Request 信息：在新页面中，可以填写一些关于 Pull Request
   的信息，例如标题、描述、标签等。这些信息可以帮助其他人更好地理解你提交的代码修改。
6. 提交 Pull Request：最后，点击 “Create Pull Request” 按钮提交 Pull Request。
7. 等待审核：一旦提交了 Pull Request，等我审核你的修改。如果审核通过，你的修改将合并到目标仓库中。